# Fichero de configuracion base de agentes de Pandora FMS
# Base config file for Pandora FMS agents
# Version 1.2
# Licensed under GPL license, 2003-2006 Sancho Lerena

# General Parameters
# ==================

server_ip 	192.168.50.100
server_path 	/opt/pandora_server/data_in
pandora_path 	/opt/pandora_agent/
temporal    	/opt/pandora_agent/data_out
interval    	300
debug 		0
checksum 	0
#agent_name     toher

# Module Definition
# =================

# vmstat syntax depends on linux distro and vmstat command version, please check before use it
module_begin 
module_name cpu_user
module_type generic_data
module_interval 1
module_exec vmstat 1 2 | tail -1 | awk '{ print $13 }'
module_max 100
module_min 0
module_descripcion User CPU Usage (%)
module_end

module_begin 
module_name cpu_sys
module_type generic_data
module_exec vmstat 1 2 | tail -1 | awk '{ print $14 }'
module_max 100
module_min 0
module_description System CPU Usage (%)
module_end

module_begin 
module_name disk_root_free
module_type generic_data
module_interval 2
module_exec df -kh / | tail -1 | awk '{ print 100-$5 }'
module_max 100
module_min 0
module_description Free disk Percentage of root partition
module_end

module_begin
module_name memfree
module_type generic_data
module_exec cat /proc/meminfo  | grep MemFree | awk '{ print $2 }'
module_end

module_begin
module_name memused
module_type generic_data
module_exec cat /proc/meminfo | grep "Active"  | awk '{ print $2 }'
module_end

module_begin
module_name proctotal
module_type generic_data
module_exec ps -A | wc -l
module_end

module_begin
module_name snort
module_type generic_proc
module_exec ps -Af | grep snort | grep -v "grep" | wc -l
module_end

module_begin
module_name apache
module_type generic_proc
module_exec ps -Af | grep apache | grep -v "grep" | wc -l
module_end

module_begin
module_name sshDaemon
module_type generic_proc
module_exec ps -Af | grep sshd | grep -v "grep" | wc -l
module_end

module_begin
module_name last_syslog
module_type generic_data_string
module_exec tail -1 /var/log/syslog
module_end

module_begin
module_name PandoraNet_Mem
module_description Pandora_Network Memory usage
module_type generic_data
module_exec ps aux | grep pandora_network.pl | grep -v grep | awk '{ print $6 }'
module_end

module_begin
module_name PandoraSer_Mem
module_description Pandora Server memory usage
module_type generic_data
module_exec ps aux | grep pandora_server.pl | grep -v grep | awk '{ print $6 }'
module_end


